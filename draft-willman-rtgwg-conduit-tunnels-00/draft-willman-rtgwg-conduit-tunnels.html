<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Underlay for IPsec Transport</title>
<meta content="John Edward Willman V" name="author">
<meta content="
       
        This document specifies CONDUIT, a tunnel fabric management protocol
        for tactical and enterprise networks operating over heterogeneous
        Wide Area Network (WAN) links. CONDUIT automates the lifecycle
        management of IPsec tunnels, monitors tunnel health through active
        probing, and publishes quality metrics to enable Segment Routing
        over IPv6 (SRv6) based traffic engineering. 
       
        CONDUIT follows a strict separation of concerns: it manages the
        underlay tunnel fabric while delegating all traffic engineering
        decisions to SRv6. This architecture simplifies network operations,
        enables rapid adaptation to changing WAN conditions, and leverages
        standard SRv6 capabilities including Flexible Algorithm (Flex-Algo)
        and Topology-Independent Loop-Free Alternate (TI-LFA). 
       
        The protocol is fully programmable via gRPC and mandates compliance
        with Commercial National Security Algorithm Suite 2.0 (CNSA 2.0)
        cryptographic requirements. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="draft-willman-rtgwg-conduit-tunnels-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-willman-rtgwg-conduit-tunnels.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Underlay for IPsec Transport</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">V</td>
<td class="center">Expires 23 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Routing Area Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-willman-rtgwg-conduit-tunnels-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfcdraft-conduit-tunnel-fabric-01" class="eref">draft-conduit-tunnel-fabric-01</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-19" class="published">19 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-23">23 August 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. E. W. V</div>
<div class="org">Department of the Air Force</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Underlay for IPsec Transport</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
        This document specifies CONDUIT, a tunnel fabric management protocol
        for tactical and enterprise networks operating over heterogeneous
        Wide Area Network (WAN) links. CONDUIT automates the lifecycle
        management of IPsec tunnels, monitors tunnel health through active
        probing, and publishes quality metrics to enable Segment Routing
        over IPv6 (SRv6) based traffic engineering.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
        CONDUIT follows a strict separation of concerns: it manages the
        underlay tunnel fabric while delegating all traffic engineering
        decisions to SRv6. This architecture simplifies network operations,
        enables rapid adaptation to changing WAN conditions, and leverages
        standard SRv6 capabilities including Flexible Algorithm (Flex-Algo)
        and Topology-Independent Loop-Free Alternate (TI-LFA).<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">
        The protocol is fully programmable via gRPC and mandates compliance
        with Commercial National Security Algorithm Suite 2.0 (CNSA 2.0)
        cryptographic requirements.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 23 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-problem-statement" class="internal xref">Problem Statement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-design-philosophy" class="internal xref">Design Philosophy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-design-goals" class="internal xref">Design Goals</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-scope" class="internal xref">Scope</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-definitions" class="internal xref">Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-abbreviations" class="internal xref">Abbreviations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-architecture" class="internal xref">Architecture</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-system-overview" class="internal xref">System Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-tunnel-fabric-concept" class="internal xref">Tunnel Fabric Concept</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-separation-of-concerns" class="internal xref">Separation of Concerns</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-cryptographic-requirements" class="internal xref">Cryptographic Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-cnsa-20-compliance" class="internal xref">CNSA 2.0 Compliance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-mandatory-algorithms" class="internal xref">Mandatory Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-prohibited-algorithms" class="internal xref">Prohibited Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-ipsec-profile" class="internal xref">IPsec Profile</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-certificate-requirements" class="internal xref">Certificate Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-tls-requirements" class="internal xref">TLS Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-tunnel-fabric-management" class="internal xref">Tunnel Fabric Management</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-tunnel-lifecycle-states" class="internal xref">Tunnel Lifecycle States</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-tunnel-establishment-policy" class="internal xref">Tunnel Establishment Policy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-tunnel-naming-convention" class="internal xref">Tunnel Naming Convention</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-full-mesh-fabric" class="internal xref">Full Mesh Fabric</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-health-monitoring" class="internal xref">Health Monitoring</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-probe-mechanism" class="internal xref">Probe Mechanism</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-probe-packet-format" class="internal xref">Probe Packet Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-metrics-calculation" class="internal xref">Metrics Calculation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-round-trip-time" class="internal xref">Round-Trip Time</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="auto internal xref">6.3.2</a>.  <a href="#name-jitter" class="internal xref">Jitter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="auto internal xref">6.3.3</a>.  <a href="#name-packet-loss" class="internal xref">Packet Loss</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-probe-scheduling" class="internal xref">Probe Scheduling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-tunnel-state-determination" class="internal xref">Tunnel State Determination</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-metric-publishing" class="internal xref">Metric Publishing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-publishing-methods" class="internal xref">Publishing Methods</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-interface-metric-calculatio" class="internal xref">Interface Metric Calculation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-igp-te-extensions" class="internal xref">IGP TE Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-flex-algo-integration" class="internal xref">Flex-Algo Integration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-srlg-assignment" class="internal xref">SRLG Assignment</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-control-protocol" class="internal xref">Control Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-transport" class="internal xref">Transport</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-message-header" class="internal xref">Message Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-message-types" class="internal xref">Message Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-hello-message" class="internal xref">HELLO Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-wan-descriptor" class="internal xref">WAN Descriptor</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-message-authentication" class="internal xref">Message Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="auto internal xref">8.7</a>.  <a href="#name-anti-replay-protection" class="internal xref">Anti-Replay Protection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-srv6-integration" class="internal xref">SRv6 Integration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-tunnel-interfaces-as-srv6-a" class="internal xref">Tunnel Interfaces as SRv6 Adjacencies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-flex-algo-tunnel-assignment" class="internal xref">Flex-Algo Tunnel Assignment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-traffic-steering" class="internal xref">Traffic Steering</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-high-availability" class="internal xref">High Availability</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-ha-architecture" class="internal xref">HA Architecture</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-synchronized-state" class="internal xref">Synchronized State</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-failover-behavior" class="internal xref">Failover Behavior</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-grpc-api" class="internal xref">gRPC API</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-service-overview" class="internal xref">Service Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-authentication-and-authoriz" class="internal xref">Authentication and Authorization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-cryptographic-security" class="internal xref">Cryptographic Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-threat-mitigations" class="internal xref">Threat Mitigations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-operational-security" class="internal xref">Operational Security</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-udp-port-allocation" class="internal xref">UDP Port Allocation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-wan-type-registry" class="internal xref">WAN Type Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-wan-type-characteristics" class="internal xref">WAN Type Characteristics</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-1">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="sect-1.1">
<section id="section-1.1">
        <h3 id="name-problem-statement">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-problem-statement" class="section-name selfRef">Problem Statement</a>
        </h3>
<p id="section-1.1-1">
          Modern tactical and enterprise networks increasingly operate over
          diverse Wide Area Network (WAN) links with varying characteristics:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
            <p id="section-1.1-2.1.1">Satellite Communications (SATCOM): Both Geostationary (GEO) with
              approximately 600ms round-trip latency and Low Earth Orbit (LEO)
              with 20-40ms latency, limited bandwidth, and weather sensitivity.<a href="#section-1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">Line-of-Sight (LOS) Radio: Low latency, high mobility, but
              terrain-dependent coverage.<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.3">
            <p id="section-1.1-2.3.1">Cellular Networks (LTE/5G): Variable quality, broad coverage, but
              may traverse untrusted infrastructure.<a href="#section-1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.4">
            <p id="section-1.1-2.4.1">High Frequency (HF) Radio: Very low bandwidth but extended range
              with atmospheric effects.<a href="#section-1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.5">
            <p id="section-1.1-2.5.1">Wired Connections: When available at fixed installations.<a href="#section-1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-3">
          Managing IPsec tunnels across these heterogeneous links presents
          significant operational challenges:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1-4">
          <li id="section-1.1-4.1">
            <p id="section-1.1-4.1.1">Links appear and disappear as network elements move or
              environmental conditions change.<a href="#section-1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-4.2">
            <p id="section-1.1-4.2.1">Link quality varies dramatically and unpredictably.<a href="#section-1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-4.3">
            <p id="section-1.1-4.3.1">Multiple paths to each destination may exist simultaneously.<a href="#section-1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-4.4">
            <p id="section-1.1-4.4.1">Failover must complete within sub-second timeframes to maintain
              voice and command-and-control (C2) applications.<a href="#section-1.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-4.5">
            <p id="section-1.1-4.5.1">All traffic must be encrypted using approved cryptographic
              algorithms.<a href="#section-1.1-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.1-5">
          Existing approaches typically couple tunnel management with traffic
          engineering decisions, creating unnecessary complexity and limiting
          interoperability with standard routing protocols.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-1.2">
<section id="section-1.2">
        <h3 id="name-design-philosophy">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-design-philosophy" class="section-name selfRef">Design Philosophy</a>
        </h3>
<p id="section-1.2-1">
          CONDUIT adheres to a strict separation of concerns:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">
            <p id="section-1.2-2.1.1">SRv6 Traffic Engineering Layer: Responsible for all path selection
              decisions, including Flexible Algorithm computation, fast reroute
              via TI-LFA, traffic class steering, and load balancing across
              equal-cost paths.<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">CONDUIT Tunnel Fabric Layer: Responsible for tunnel lifecycle
              management (creation, maintenance, deletion), health monitoring
              through active probing, metric publication to enable SRv6-based
              decisions, and IPsec security association management.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-3">
          This separation ensures that CONDUIT does not duplicate functionality
          available in standard SRv6 implementations while providing essential
          tunnel management capabilities that SRv6 requires but does not
          natively provide.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-1.3">
<section id="section-1.3">
        <h3 id="name-design-goals">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-design-goals" class="section-name selfRef">Design Goals</a>
        </h3>
<p id="section-1.3-1">
          The following quantitative goals guide CONDUIT's design:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Parameter</th>
              <th class="text-left" rowspan="1" colspan="1"> Requirement</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Tunnel Scale</td>
              <td class="text-left" rowspan="1" colspan="1">Support for 1000+ tunnels per node</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Failover Detection</td>
              <td class="text-left" rowspan="1" colspan="1">Less than 500ms to detect tunnel failure</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Metric Publish Rate</td>
              <td class="text-left" rowspan="1" colspan="1">1 Hz default, 10 Hz burst capability</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Cryptographic Suite</td>
              <td class="text-left" rowspan="1" colspan="1">Full CNSA 2.0 compliance</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">API Coverage</td>
              <td class="text-left" rowspan="1" colspan="1">100% of functionality accessible via gRPC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Probe Overhead</td>
              <td class="text-left" rowspan="1" colspan="1">Less than 1% of available bandwidth</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-1.4">
<section id="section-1.4">
        <h3 id="name-scope">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
        </h3>
<p id="section-1.4-1">
          This document specifies:<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-2.1">
            <p id="section-1.4-2.1.1">Tunnel lifecycle management procedures<a href="#section-1.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-2.2">
            <p id="section-1.4-2.2.1">Health monitoring through active probing<a href="#section-1.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-2.3">
            <p id="section-1.4-2.3.1">Metric calculation and publishing mechanisms<a href="#section-1.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-2.4">
            <p id="section-1.4-2.4.1">Control protocol message formats<a href="#section-1.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-2.5">
            <p id="section-1.4-2.5.1">Integration requirements for SRv6-based traffic engineering<a href="#section-1.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-2.6">
            <p id="section-1.4-2.6.1">Cryptographic requirements for CNSA 2.0 compliance<a href="#section-1.4-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.4-3">
          This document does not specify:<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-4.1">
            <p id="section-1.4-4.1.1">SRv6 data plane operations (covered by <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>)<a href="#section-1.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-4.2">
            <p id="section-1.4-4.2.1">Flexible Algorithm computation (covered by
              draft-ietf-lsr-flex-algo)<a href="#section-1.4-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-4.3">
            <p id="section-1.4-4.3.1">IPsec key exchange procedures (covered by <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>)<a href="#section-1.4-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-4.4">
            <p id="section-1.4-4.4.1">IGP extensions for traffic engineering (covered by <span>[<a href="#RFC8570" class="cite xref">RFC8570</a>]</span>)<a href="#section-1.4-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sect-2">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<div id="sect-2.1">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1"> The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
          NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
          interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2.2">
<section id="section-2.2">
        <h3 id="name-definitions">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-2.2-1">
          <dt id="section-2.2-1.1">Node:</dt>
          <dd style="margin-left: 0.5em" id="section-2.2-1.2">
            <p id="section-2.2-1.2.1">
              A device implementing the CONDUIT protocol.<a href="#section-2.2-1.2.1" class="pilcrow">¶</a></p>
<p id="section-2.2-1.2.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-1.3">Peer:</dt>
          <dd style="margin-left: 0.5em" id="section-2.2-1.4">
            <p id="section-2.2-1.4.1">
              A remote node with which tunnels are established.<a href="#section-2.2-1.4.1" class="pilcrow">¶</a></p>
<p id="section-2.2-1.4.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-1.5">WAN:</dt>
          <dd style="margin-left: 0.5em" id="section-2.2-1.6">
            <p id="section-2.2-1.6.1">
              A Wide Area Network interface, either physical or virtual,<a href="#section-2.2-1.6.1" class="pilcrow">¶</a></p>
<p id="section-2.2-1.6.2">
              capable of carrying IP traffic to remote peers.<a href="#section-2.2-1.6.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-1.7">Tunnel:</dt>
          <dd style="margin-left: 0.5em" id="section-2.2-1.8">
            <p id="section-2.2-1.8.1">
              An IPsec-protected communication path between two WAN<a href="#section-2.2-1.8.1" class="pilcrow">¶</a></p>
<p id="section-2.2-1.8.2">
              interfaces on different nodes.<a href="#section-2.2-1.8.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-1.9">Fabric:</dt>
          <dd style="margin-left: 0.5em" id="section-2.2-1.10">
            <p id="section-2.2-1.10.1">
              The complete set of tunnels managed by a CONDUIT node.<a href="#section-2.2-1.10.1" class="pilcrow">¶</a></p>
<p id="section-2.2-1.10.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-1.11">Probe:</dt>
          <dd style="margin-left: 0.5em" id="section-2.2-1.12">
            <p id="section-2.2-1.12.1">
              A measurement packet transmitted through a tunnel to assess<a href="#section-2.2-1.12.1" class="pilcrow">¶</a></p>
<p id="section-2.2-1.12.2">
              its quality characteristics.<a href="#section-2.2-1.12.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-1.13">Metric:</dt>
          <dd style="margin-left: 0.5em" id="section-2.2-1.14">
            <p id="section-2.2-1.14.1">
              A quantitative measure of tunnel quality, such as latency,<a href="#section-2.2-1.14.1" class="pilcrow">¶</a></p>
<p id="section-2.2-1.14.2">
              jitter, or packet loss.<a href="#section-2.2-1.14.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-1.15">Locator:</dt>
          <dd style="margin-left: 0.5em" id="section-2.2-1.16">
            <p id="section-2.2-1.16.1">
              The SRv6 locator block assigned to a node, typically a /48<a href="#section-2.2-1.16.1" class="pilcrow">¶</a></p>
<p id="section-2.2-1.16.2">
              IPv6 prefix.<a href="#section-2.2-1.16.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-2.3">
<section id="section-2.3">
        <h3 id="name-abbreviations">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-abbreviations" class="section-name selfRef">Abbreviations</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-2.3-1">
          <dt id="section-2.3-1.1">CNSA:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.2">
            <p id="section-2.3-1.2.1">
              Commercial National Security Algorithm Suite<a href="#section-2.3-1.2.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.2.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.3">ECMP:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.4">
            <p id="section-2.3-1.4.1">
              Equal-Cost Multi-Path<a href="#section-2.3-1.4.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.4.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.5">ESP:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.6">
            <p id="section-2.3-1.6.1">
              Encapsulating Security Payload<a href="#section-2.3-1.6.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.6.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.7">Flex-Algo:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.8">
            <p id="section-2.3-1.8.1">
              Flexible Algorithm<a href="#section-2.3-1.8.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.8.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.9">GEO:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.10">
            <p id="section-2.3-1.10.1">
              Geostationary Earth Orbit<a href="#section-2.3-1.10.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.10.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.11">gRPC:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.12">
            <p id="section-2.3-1.12.1">
              gRPC Remote Procedure Call<a href="#section-2.3-1.12.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.12.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.13">HMAC:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.14">
            <p id="section-2.3-1.14.1">
              Hash-based Message Authentication Code<a href="#section-2.3-1.14.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.14.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.15">IGP:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.16">
            <p id="section-2.3-1.16.1">
              Interior Gateway Protocol<a href="#section-2.3-1.16.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.16.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.17">IKE:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.18">
            <p id="section-2.3-1.18.1">
              Internet Key Exchange<a href="#section-2.3-1.18.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.18.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.19">LEO:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.20">
            <p id="section-2.3-1.20.1">
              Low Earth Orbit<a href="#section-2.3-1.20.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.20.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.21">LOS:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.22">
            <p id="section-2.3-1.22.1">
              Line-of-Sight<a href="#section-2.3-1.22.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.22.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.23">mTLS:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.24">
            <p id="section-2.3-1.24.1">
              Mutual Transport Layer Security<a href="#section-2.3-1.24.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.24.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.25">RTT:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.26">
            <p id="section-2.3-1.26.1">
              Round-Trip Time<a href="#section-2.3-1.26.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.26.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.27">SA:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.28">
            <p id="section-2.3-1.28.1">
              Security Association<a href="#section-2.3-1.28.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.28.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.29">SPI:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.30">
            <p id="section-2.3-1.30.1">
              Security Parameter Index<a href="#section-2.3-1.30.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.30.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.31">SRLG:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.32">
            <p id="section-2.3-1.32.1">
              Shared Risk Link Group<a href="#section-2.3-1.32.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.32.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.33">SRv6:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.34">
            <p id="section-2.3-1.34.1">
              Segment Routing over IPv6<a href="#section-2.3-1.34.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.34.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-1.35">TE:</dt>
          <dd style="margin-left: 0.5em" id="section-2.3-1.36">
            <p id="section-2.3-1.36.1">
              Traffic Engineering<a href="#section-2.3-1.36.1" class="pilcrow">¶</a></p>
<p id="section-2.3-1.36.2"></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.3-2">
          TI-LFA: Topology-Independent Loop-Free Alternate<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-3">
<section id="section-3">
      <h2 id="name-architecture">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-architecture" class="section-name selfRef">Architecture</a>
      </h2>
<div id="sect-3.1">
<section id="section-3.1">
        <h3 id="name-system-overview">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-system-overview" class="section-name selfRef">System Overview</a>
        </h3>
<p id="section-3.1-1">
          A CONDUIT deployment consists of the following components:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">SDN Controller (Optional): Provides centralized policy management,
              SRv6 policy configuration, and network-wide optimization.
              Communicates with CONDUIT nodes via gRPC.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">SRv6 Data Plane: Executes traffic engineering decisions using
              standard SRv6 mechanisms including IS-IS or OSPFv3 with SRv6
              extensions, Flexible Algorithm for constraint-based path
              computation, and TI-LFA for sub-50ms fast reroute.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">CONDUIT Daemon: Manages the tunnel fabric, comprising the Tunnel
              Lifecycle Manager for creating and deleting tunnels, Health
              Monitor for probing tunnel quality, Metric Publisher for feeding
              metrics to SRv6/IGP, and the gRPC API Server for external control.<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">IKEv2/IPsec Subsystem: Handles cryptographic operations and
              security association management. CONDUIT interfaces with this
              subsystem but does not implement cryptographic operations directly.<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.5">
            <p id="section-3.1-2.5.1">WAN Interfaces: Physical or virtual interfaces connecting to
              various transport networks.<a href="#section-3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-3.2">
<section id="section-3.2">
        <h3 id="name-tunnel-fabric-concept">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-tunnel-fabric-concept" class="section-name selfRef">Tunnel Fabric Concept</a>
        </h3>
<p id="section-3.2-1">
          CONDUIT creates tunnels between WAN interfaces according to the
          configured tunnel policy. In a full mesh configuration with N local
          WANs and M remote WANs to a given peer, CONDUIT establishes up to
          N x M tunnels.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
          For example, consider a node with three WAN interfaces (SATCOM, LOS
          Radio, and LTE) connecting to a peer also having three WAN
          interfaces. A full mesh fabric would comprise nine tunnels:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">SATCOM to SATCOM<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">SATCOM to LOS<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.3">
            <p id="section-3.2-3.3.1">SATCOM to LTE<a href="#section-3.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.4">
            <p id="section-3.2-3.4.1">LOS to SATCOM<a href="#section-3.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.5">
            <p id="section-3.2-3.5.1">LOS to LOS<a href="#section-3.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.6">
            <p id="section-3.2-3.6.1">LOS to LTE<a href="#section-3.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.7">
            <p id="section-3.2-3.7.1">LTE to SATCOM<a href="#section-3.2-3.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.8">
            <p id="section-3.2-3.8.1">LTE to LOS<a href="#section-3.2-3.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.9">
            <p id="section-3.2-3.9.1">LTE to LTE<a href="#section-3.2-3.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-4">
          Each tunnel becomes a distinct interface visible to the SRv6 data
          plane and IGP. The IGP sees multiple adjacencies to the same peer,
          each with potentially different metrics based on tunnel quality.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.3">
<section id="section-3.3">
        <h3 id="name-separation-of-concerns">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-separation-of-concerns" class="section-name selfRef">Separation of Concerns</a>
        </h3>
<p id="section-3.3-1">
          CONDUIT explicitly delegates the following functions to SRv6:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Function</th>
              <th class="text-left" rowspan="1" colspan="1"> Mechanism</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Path Selection</td>
              <td class="text-left" rowspan="1" colspan="1">SRv6 Flex-Algo, IGP SPF computation</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Traffic Classification</td>
              <td class="text-left" rowspan="1" colspan="1">SRv6 Policy color matching</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Load Balancing</td>
              <td class="text-left" rowspan="1" colspan="1">IGP ECMP across equal-metric tunnels</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Fast Reroute</td>
              <td class="text-left" rowspan="1" colspan="1">TI-LFA pre-computed backup paths</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">QoS Marking</td>
              <td class="text-left" rowspan="1" colspan="1">SRv6 Traffic Class field</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.3-3" class="keepWithPrevious"> CONDUIT is responsible for:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Function</th>
              <th class="text-left" rowspan="1" colspan="1"> Mechanism</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Tunnel Creation</td>
              <td class="text-left" rowspan="1" colspan="1">Automatic based on WAN availability</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Tunnel Deletion</td>
              <td class="text-left" rowspan="1" colspan="1">Automatic when WAN becomes unavailable</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Health Monitoring</td>
              <td class="text-left" rowspan="1" colspan="1">Active probing with configurable rates</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Metric Calculation</td>
              <td class="text-left" rowspan="1" colspan="1">RTT, jitter, loss measurement</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Metric Publishing</td>
              <td class="text-left" rowspan="1" colspan="1">Interface metrics, IGP TE extensions</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IPsec SA Management</td>
              <td class="text-left" rowspan="1" colspan="1">Via IKEv2 with CNSA 2.0 parameters</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="sect-4">
<section id="section-4">
      <h2 id="name-cryptographic-requirements">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-cryptographic-requirements" class="section-name selfRef">Cryptographic Requirements</a>
      </h2>
<div id="sect-4.1">
<section id="section-4.1">
        <h3 id="name-cnsa-20-compliance">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-cnsa-20-compliance" class="section-name selfRef">CNSA 2.0 Compliance</a>
        </h3>
<p id="section-4.1-1">
          CONDUIT implementations MUST comply with the Commercial National
          Security Algorithm Suite 2.0 (CNSA 2.0) as specified by the National
          Security Agency for protection of classified information.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
          Implementations intended for use in environments not requiring CNSA
          2.0 compliance MAY support additional algorithms but MUST default to
          CNSA 2.0 algorithms and MUST provide configuration options to enforce
          CNSA 2.0-only operation.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.2">
<section id="section-4.2">
        <h3 id="name-mandatory-algorithms">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-mandatory-algorithms" class="section-name selfRef">Mandatory Algorithms</a>
        </h3>
<p id="section-4.2-1">
          The following algorithms are REQUIRED:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Function</th>
              <th class="text-left" rowspan="1" colspan="1"> Algorithm</th>
              <th class="text-left" rowspan="1" colspan="1"> Parameters</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Symmetric Encryption</td>
              <td class="text-left" rowspan="1" colspan="1">AES-256-GCM </td>
              <td class="text-left" rowspan="1" colspan="1">256-bit key, 96-bit IV, 128-bit authentication tag</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Key Exchange</td>
              <td class="text-left" rowspan="1" colspan="1">ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">P-384 curve (secp384r1)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Digital Signature</td>
              <td class="text-left" rowspan="1" colspan="1">ECDSA</td>
              <td class="text-left" rowspan="1" colspan="1">P-384 curve (secp384r1)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Hash Function</td>
              <td class="text-left" rowspan="1" colspan="1">SHA-384</td>
              <td class="text-left" rowspan="1" colspan="1">384-bit output</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Message Authentication</td>
              <td class="text-left" rowspan="1" colspan="1">HMAC-SHA-384 <span>[<a href="#RFC4868" class="cite xref">RFC4868</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">384-bit output </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Pseudo-Random Function (IKEv2)</td>
              <td class="text-left" rowspan="1" colspan="1">HMAC-SHA-384</td>
              <td class="text-left" rowspan="1" colspan="1">Per <span>[<a href="#RFC4868" class="cite xref">RFC4868</a>]</span>
              </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Key Derivation</td>
              <td class="text-left" rowspan="1" colspan="1">HKDF-SHA-384</td>
              <td class="text-left" rowspan="1" colspan="1">Per <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span>
</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-4.3">
<section id="section-4.3">
        <h3 id="name-prohibited-algorithms">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-prohibited-algorithms" class="section-name selfRef">Prohibited Algorithms</a>
        </h3>
<p id="section-4.3-1">
          CONDUIT implementations MUST reject configuration of the following
          algorithms and MUST NOT negotiate their use:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">
            <p id="section-4.3-2.1.1">AES with key sizes less than 256 bits (AES-128, AES-192)<a href="#section-4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.2">
            <p id="section-4.3-2.2.1">Triple DES (3DES) and DES<a href="#section-4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.3">
            <p id="section-4.3-2.3.1">SHA-1 and SHA-256 for authentication or integrity<a href="#section-4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.4">
            <p id="section-4.3-2.4.1">MD5<a href="#section-4.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.5">
            <p id="section-4.3-2.5.1">RSA with key sizes less than 3072 bits<a href="#section-4.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.6">
            <p id="section-4.3-2.6.1">Diffie-Hellman groups with less than 3072-bit modulus<a href="#section-4.3-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.7">
            <p id="section-4.3-2.7.1">ECDH or ECDSA with curves smaller than P-384<a href="#section-4.3-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.8">
            <p id="section-4.3-2.8.1">ChaCha20-Poly1305 (not approved for CNSA)<a href="#section-4.3-2.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-3">
          Implementations MUST generate a configuration error and refuse to
          operate if prohibited algorithms are specified.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.4">
<section id="section-4.4">
        <h3 id="name-ipsec-profile">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-ipsec-profile" class="section-name selfRef">IPsec Profile</a>
        </h3>
<p id="section-4.4-1">
          CONDUIT implementations MUST configure IPsec with the following
          parameters:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">
          IKEv2 Parameters:<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-3.1">
            <p id="section-4.4-3.1.1">Version: IKEv2 only (version 1 MUST NOT be used)<a href="#section-4.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-3.2">
            <p id="section-4.4-3.2.1">Encryption: AES-256-GCM with 16-octet ICV (aes256gcm16)<a href="#section-4.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-3.3">
            <p id="section-4.4-3.3.1">PRF: HMAC-SHA-384 (prf-hmac-sha384)<a href="#section-4.4-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-3.4">
            <p id="section-4.4-3.4.1">Diffie-Hellman Group: 20 (384-bit random ECP, P-384)<a href="#section-4.4-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-3.5">
            <p id="section-4.4-3.5.1">Authentication: ECDSA with SHA-384 using P-384 certificates<a href="#section-4.4-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-4">
          ESP (Child SA) Parameters:<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-5.1">
            <p id="section-4.4-5.1.1">Encryption: AES-256-GCM with 16-octet ICV<a href="#section-4.4-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-5.2">
            <p id="section-4.4-5.2.1">Extended Sequence Numbers: Enabled<a href="#section-4.4-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-5.3">
            <p id="section-4.4-5.3.1">Traffic Selectors: As required for overlay traffic<a href="#section-4.4-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-6">
          Lifetime Parameters:<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-7.1">
            <p id="section-4.4-7.1.1">IKE SA Lifetime: 86400 seconds (24 hours) maximum<a href="#section-4.4-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-7.2">
            <p id="section-4.4-7.2.1">Child SA Lifetime: 28800 seconds (8 hours) maximum<a href="#section-4.4-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-7.3">
            <p id="section-4.4-7.3.1">Child SA Volume Limit: 1 TiB maximum<a href="#section-4.4-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-4.5">
<section id="section-4.5">
        <h3 id="name-certificate-requirements">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-certificate-requirements" class="section-name selfRef">Certificate Requirements</a>
        </h3>
<p id="section-4.5-1">
          Node certificates MUST meet the following requirements:<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.1">
            <p id="section-4.5-2.1.1">Format: X.509 version 3<a href="#section-4.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-2.2">
            <p id="section-4.5-2.2.1">Key Algorithm: ECDSA with P-384 curve<a href="#section-4.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-2.3">
            <p id="section-4.5-2.3.1">Signature Algorithm: ecdsa-with-SHA384<a href="#section-4.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-2.4">
            <p id="section-4.5-2.4.1">Key Usage: digitalSignature, keyAgreement<a href="#section-4.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-2.5">
            <p id="section-4.5-2.5.1">Extended Key Usage: serverAuth, clientAuth, IPsecIKE<a href="#section-4.5-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.5-3">
          Certificate Authority certificates MUST use ECDSA with P-384 and
          SHA-384 signatures.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">
          Certificate validation MUST include revocation checking via CRL or
          OCSP when network connectivity permits.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.6">
<section id="section-4.6">
        <h3 id="name-tls-requirements">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-tls-requirements" class="section-name selfRef">TLS Requirements</a>
        </h3>
<p id="section-4.6-1">
          The gRPC API MUST be protected using TLS with the following
          configuration:<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.1">
            <p id="section-4.6-2.1.1">Minimum Version: TLS 1.3 (TLS 1.2 and earlier MUST NOT be used)<a href="#section-4.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-2.2">
            <p id="section-4.6-2.2.1">Cipher Suite: TLS_AES_256_GCM_SHA384 only<a href="#section-4.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-2.3">
            <p id="section-4.6-2.3.1">Certificate Type: ECDSA with P-384 curve<a href="#section-4.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-2.4">
            <p id="section-4.6-2.4.1">Client Authentication: Required (mutual TLS)<a href="#section-4.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.6-3">
          Implementations MUST reject TLS connections that do not meet these
          requirements.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5">
<section id="section-5">
      <h2 id="name-tunnel-fabric-management">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-tunnel-fabric-management" class="section-name selfRef">Tunnel Fabric Management</a>
      </h2>
<div id="sect-5.1">
<section id="section-5.1">
        <h3 id="name-tunnel-lifecycle-states">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-tunnel-lifecycle-states" class="section-name selfRef">Tunnel Lifecycle States</a>
        </h3>
<p id="section-5.1-1">
          Each tunnel exists in one of the following states:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-2">
          <dt id="section-5.1-2.1">DISCOVERED:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">
              A peer has been discovered but tunnel establishment has<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.1-2.2.2">
              not begun. Entry: peer discovery. Exit: initiate IKEv2.<a href="#section-5.1-2.2.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.3">INITIATING:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.4">
            <p id="section-5.1-2.4.1">
              IKEv2 negotiation is in progress. Entry: IKEv2<a href="#section-5.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-5.1-2.4.2">
              initiation. Exit: IKE_SA and CHILD_SA established, or timeout/
              failure.<a href="#section-5.1-2.4.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.5">ESTABLISHED:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.6">
            <p id="section-5.1-2.6.1">
              The tunnel is operational and probes are succeeding<a href="#section-5.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-5.1-2.6.2">
              within acceptable thresholds. Entry: successful IKEv2 completion
              or recovery from DEGRADED. Exit: metrics degrade, probe failures
              accumulate, or rekey initiated.<a href="#section-5.1-2.6.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.7">DEGRADED:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.8">
            <p id="section-5.1-2.8.1">
              The tunnel is operational but metrics exceed preferred<a href="#section-5.1-2.8.1" class="pilcrow">¶</a></p>
<p id="section-5.1-2.8.2">
              thresholds. Entry: metrics exceed degradation thresholds. Exit:
              metrics recover or probe failures accumulate.<a href="#section-5.1-2.8.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.9">REKEYING:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.10">
            <p id="section-5.1-2.10.1">
              Security association rekeying is in progress. Entry:<a href="#section-5.1-2.10.1" class="pilcrow">¶</a></p>
<p id="section-5.1-2.10.2">
              rekey initiated (time or volume based). Exit: rekey success or
              failure.<a href="#section-5.1-2.10.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.11">DOWN:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.12">
            <p id="section-5.1-2.12.1">
              The tunnel has failed and is not currently usable. Entry:<a href="#section-5.1-2.12.1" class="pilcrow">¶</a></p>
<p id="section-5.1-2.12.2">
              consecutive probe failures exceed threshold or IKE failure. Exit:
              probes succeed or WAN becomes unavailable.<a href="#section-5.1-2.12.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.13">DELETED:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.14">
            <p id="section-5.1-2.14.1">
              The tunnel is marked for removal. Entry: WAN unavailable<a href="#section-5.1-2.14.1" class="pilcrow">¶</a></p>
<p id="section-5.1-2.14.2">
              or administrative deletion. Exit: cleanup complete.<a href="#section-5.1-2.14.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-3">
          State transitions MUST be reported via the gRPC API event stream and
          SHOULD be logged for operational visibility.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2">
<section id="section-5.2">
        <h3 id="name-tunnel-establishment-policy">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-tunnel-establishment-policy" class="section-name selfRef">Tunnel Establishment Policy</a>
        </h3>
<p id="section-5.2-1">
          CONDUIT supports three fabric modes:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-2">
          <dt id="section-5.2-2.1">Full Mesh:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">
              Create tunnels for all combinations of local and remote<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.2-2.2.2">
              WAN interfaces. This mode maximizes path diversity but increases
              resource consumption.<a href="#section-5.2-2.2.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.3">Primary Only:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.4">
            <p id="section-5.2-2.4.1">
              Create tunnels only between designated primary WAN<a href="#section-5.2-2.4.1" class="pilcrow">¶</a></p>
<p id="section-5.2-2.4.2">
              interfaces on each node. This mode minimizes resource consumption
              but limits path diversity.<a href="#section-5.2-2.4.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.5">Custom:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.6">
            <p id="section-5.2-2.6.1">
              Apply a rule-based policy to determine which tunnel<a href="#section-5.2-2.6.1" class="pilcrow">¶</a></p>
<p id="section-5.2-2.6.2">
              combinations to establish. Rules may specify:<a href="#section-5.2-2.6.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.6.3.1">
                <p id="section-5.2-2.6.3.1.1">Local WAN type (e.g., SATCOM, LOS, cellular)<a href="#section-5.2-2.6.3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.6.3.2">
                <p id="section-5.2-2.6.3.2.1">Remote WAN type<a href="#section-5.2-2.6.3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.6.3.3">
                <p id="section-5.2-2.6.3.3.1">Action (create or skip)<a href="#section-5.2-2.6.3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.6.3.4">
                <p id="section-5.2-2.6.3.4.1">Priority (affects establishment order)<a href="#section-5.2-2.6.3.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-3">
          The tunnel policy SHOULD be configurable via the gRPC API and SHOULD
          support runtime modification without service interruption.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3">
<section id="section-5.3">
        <h3 id="name-tunnel-naming-convention">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-tunnel-naming-convention" class="section-name selfRef">Tunnel Naming Convention</a>
        </h3>
<p id="section-5.3-1">
          Tunnel interfaces SHOULD be named according to the following
          convention to facilitate operational identification:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3-2">
          <dt id="section-5.3-2.1"></dt>
          <dd style="margin-left: 1.5em" id="section-5.3-2.2">
            tun-&lt;peer&gt;-&lt;local_wan&gt;-&lt;remote_wan&gt;<a href="#section-5.3-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.3-3">
          Where:<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-4.1">
            <p id="section-5.3-4.1.1">&lt;peer&gt; is a short identifier for the remote node<a href="#section-5.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-4.2">
            <p id="section-5.3-4.2.1">&lt;local_wan&gt; is a short identifier for the local WAN interface<a href="#section-5.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-4.3">
            <p id="section-5.3-4.3.1">&lt;remote_wan&gt; is a short identifier for the remote WAN interface<a href="#section-5.3-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.3-5">
          Example names:<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-6.1">
            <p id="section-5.3-6.1.1">tun-hq-sat-sat (to headquarters, SATCOM to SATCOM)<a href="#section-5.3-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-6.2">
            <p id="section-5.3-6.2.1">tun-hq-los-lte (to headquarters, LOS radio to LTE)<a href="#section-5.3-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-6.3">
            <p id="section-5.3-6.3.1">tun-fwd1-hf-hf (to forward unit 1, HF to HF)<a href="#section-5.3-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-5.4">
<section id="section-5.4">
        <h3 id="name-full-mesh-fabric">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-full-mesh-fabric" class="section-name selfRef">Full Mesh Fabric</a>
        </h3>
<p id="section-5.4-1">
          When operating in full mesh mode, the number of tunnels T to a single
          peer is:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-2">
<pre>
   T = L x R
</pre><a href="#section-5.4-2" class="pilcrow">¶</a>
</div>
<p id="section-5.4-3">
          Where L is the number of local WAN interfaces and R is the number of
          remote WAN interfaces on the peer.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.4-4">
          <dt id="section-5.4-4.1">The total tunnels across all peers is:</dt>
          <dd style="margin-left: 0.5em" id="section-5.4-4.2"></dd>
        <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-5.4-5">
<pre>
   Total = sum(L x R_i) for each peer i

Implementations MUST support configurable limits on:
</pre><a href="#section-5.4-5" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-5.4-6.1">
            <p id="section-5.4-6.1.1">Maximum tunnels per peer<a href="#section-5.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-6.2">
            <p id="section-5.4-6.2.1">Maximum total tunnels<a href="#section-5.4-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.4-7">
          When limits would be exceeded, implementations SHOULD prioritize
          tunnel creation based on configured policy and WAN type preferences.<a href="#section-5.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-6">
<section id="section-6">
      <h2 id="name-health-monitoring">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-health-monitoring" class="section-name selfRef">Health Monitoring</a>
      </h2>
<div id="sect-6.1">
<section id="section-6.1">
        <h3 id="name-probe-mechanism">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-probe-mechanism" class="section-name selfRef">Probe Mechanism</a>
        </h3>
<p id="section-6.1-1">
          CONDUIT monitors tunnel health through active probing. Each tunnel
          is independently probed to measure:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
          <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Metric</th>
              <th class="text-left" rowspan="1" colspan="1"> Unit</th>
              <th class="text-left" rowspan="1" colspan="1"> Collection Method</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Round-Trip Time</td>
              <td class="text-left" rowspan="1" colspan="1">Microseconds</td>
              <td class="text-left" rowspan="1" colspan="1">Timestamp echo</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Jitter</td>
              <td class="text-left" rowspan="1" colspan="1">Microseconds</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC3550" class="cite xref">RFC3550</a>]</span> algorithm</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Packet Loss</td>
              <td class="text-left" rowspan="1" colspan="1">Percentage</td>
              <td class="text-left" rowspan="1" colspan="1">Sequence tracking</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Availability</td>
              <td class="text-left" rowspan="1" colspan="1">Percentage</td>
              <td class="text-left" rowspan="1" colspan="1">Probe success rate</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-6.2">
<section id="section-6.2">
        <h3 id="name-probe-packet-format">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-probe-packet-format" class="section-name selfRef">Probe Packet Format</a>
        </h3>
<p id="section-6.2-1">
          CONDUIT probe packets use the following format:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-2">
<pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Magic (0x434E4454)                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Version    |     Type      |            Flags              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Sequence Number                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                    TX Timestamp (64-bit)                      +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                    RX Timestamp (64-bit)                      +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                      HMAC-SHA-384                             +
|                        (384 bits)                             |
+                                                               +
|                                                               |
+                                                               +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                     Padding (variable)                        +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Field descriptions:
</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.2-3">
          <dt id="section-6.2-3.1">Magic (32 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.2">
            <p id="section-6.2-3.2.1">
              Fixed value 0x434E4454 ("CNDT" in ASCII). Used to<a href="#section-6.2-3.2.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.2.2">
              identify CONDUIT probe packets.<a href="#section-6.2-3.2.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.3">Version (8 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.4">
            <p id="section-6.2-3.4.1">
              Protocol version. This specification defines<a href="#section-6.2-3.4.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.4.2">
              version 1.<a href="#section-6.2-3.4.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.5">Type (8 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.6">
            <p id="section-6.2-3.6.1">
              Probe type:<a href="#section-6.2-3.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.6.2.1">
                <p id="section-6.2-3.6.2.1.1">0x01: Echo Request<a href="#section-6.2-3.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.2-3.6.2.2">
                <p id="section-6.2-3.6.2.2.1">0x02: Echo Reply<a href="#section-6.2-3.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.2-3.6.2.3">
                <p id="section-6.2-3.6.2.3.1">0x03: Timestamp Request<a href="#section-6.2-3.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.2-3.6.2.4">
                <p id="section-6.2-3.6.2.4.1">0x04: Timestamp Reply<a href="#section-6.2-3.6.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.7">Flags (16 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.8">
            <p id="section-6.2-3.8.1">
              Reserved for future use. MUST be set to zero on<a href="#section-6.2-3.8.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.8.2">
              transmission and ignored on receipt.<a href="#section-6.2-3.8.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.9">Sequence Number (32 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.10">
            <p id="section-6.2-3.10.1">
              Monotonically increasing sequence number<a href="#section-6.2-3.10.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.10.2">
              used for loss detection and RTT matching.<a href="#section-6.2-3.10.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.11">TX Timestamp (64 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.12">
            <p id="section-6.2-3.12.1">
              Transmission timestamp in microseconds since<a href="#section-6.2-3.12.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.12.2">
              the Unix epoch. Set by the sender.<a href="#section-6.2-3.12.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.13">RX Timestamp (64 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.14">
            <p id="section-6.2-3.14.1">
              Reception timestamp in microseconds since<a href="#section-6.2-3.14.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.14.2">
              the Unix epoch. Set by the responder in reply packets; zero in
              request packets.<a href="#section-6.2-3.14.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.15">HMAC-SHA-384 (384 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.16">
            <p id="section-6.2-3.16.1">
              Message authentication code computed over<a href="#section-6.2-3.16.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.16.2">
              all preceding fields. Provides probe authenticity and integrity.<a href="#section-6.2-3.16.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.17">Padding (variable):</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.18">
            <p id="section-6.2-3.18.1">
              Optional padding to achieve desired probe size<a href="#section-6.2-3.18.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.18.2">
              for bandwidth estimation or MTU testing.<a href="#section-6.2-3.18.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-6.3">
<section id="section-6.3">
        <h3 id="name-metrics-calculation">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-metrics-calculation" class="section-name selfRef">Metrics Calculation</a>
        </h3>
<div id="sect-6.3.1">
<section id="section-6.3.1">
          <h4 id="name-round-trip-time">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-round-trip-time" class="section-name selfRef">Round-Trip Time</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.3.1-1">
            <dt id="section-6.3.1-1.1">RTT is calculated as:</dt>
            <dd style="margin-left: 0.5em" id="section-6.3.1-1.2"></dd>
          <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-6.3.1-2">
<pre>
   RTT = T_local_rx - T_local_tx
</pre><a href="#section-6.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1-3">
            Where T_local_rx is the local time when the reply was received and
            T_local_tx is the local time when the request was sent.<a href="#section-6.3.1-3" class="pilcrow">¶</a></p>
<p id="section-6.3.1-4">
            For more accurate one-way delay measurement when nodes have
            synchronized clocks:<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1-5">
<pre>
   OWD_forward = T_remote_rx - T_local_tx
   OWD_reverse = T_local_rx - T_remote_tx
</pre><a href="#section-6.3.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-6.3.2">
<section id="section-6.3.2">
          <h4 id="name-jitter">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-jitter" class="section-name selfRef">Jitter</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.3.2-1">
            <dt id="section-6.3.2-1.1">Jitter is calculated using the algorithm specified in [RFC3550]:</dt>
            <dd style="margin-left: 0.5em" id="section-6.3.2-1.2"></dd>
          <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-6.3.2-2">
<pre>
   D(i) = (R(i) - R(i-1)) - (S(i) - S(i-1))
   J(i) = J(i-1) + (|D(i)| - J(i-1)) / 16

Where:
</pre><a href="#section-6.3.2-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-6.3.2-3.1">
              <p id="section-6.3.2-3.1.1">R(i) is the receive timestamp of probe i<a href="#section-6.3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.3.2-3.2">
              <p id="section-6.3.2-3.2.1">S(i) is the send timestamp of probe i<a href="#section-6.3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.3.2-3.3">
              <p id="section-6.3.2-3.3.1">J(i) is the jitter estimate after probe i<a href="#section-6.3.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sect-6.3.3">
<section id="section-6.3.3">
          <h4 id="name-packet-loss">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-packet-loss" class="section-name selfRef">Packet Loss</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.3.3-1">
            <dt id="section-6.3.3-1.1">Packet loss is calculated over a sliding window:</dt>
            <dd style="margin-left: 1.5em" id="section-6.3.3-1.2">
              Loss% = ((Probes_sent - Probes_received) / Probes_sent) x 100<a href="#section-6.3.3-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.3.3-2">
            The default window size is 100 probes. Implementations SHOULD make
            this configurable.<a href="#section-6.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-6.4">
<section id="section-6.4">
        <h3 id="name-probe-scheduling">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-probe-scheduling" class="section-name selfRef">Probe Scheduling</a>
        </h3>
<p id="section-6.4-1">
          The base probe interval is configurable, with a default of 100ms.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">
          The effective probe interval SHOULD be adjusted based on tunnel
          state:<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<table class="center" id="table-6">
          <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> State</th>
              <th class="text-left" rowspan="1" colspan="1"> Multiplier</th>
              <th class="text-left" rowspan="1" colspan="1"> Rationale</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Established</td>
              <td class="text-left" rowspan="1" colspan="1">1.0</td>
              <td class="text-left" rowspan="1" colspan="1">Normal monitoring</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Degraded</td>
              <td class="text-left" rowspan="1" colspan="1">0.5</td>
              <td class="text-left" rowspan="1" colspan="1">Increased monitoring of troubled tunnel</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Recovering</td>
              <td class="text-left" rowspan="1" colspan="1">0.25</td>
              <td class="text-left" rowspan="1" colspan="1">Rapid assessment during recovery</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Down</td>
              <td class="text-left" rowspan="1" colspan="1">2.0</td>
              <td class="text-left" rowspan="1" colspan="1">Reduced load on failed path</td>
            </tr>
          </tbody>
        </table>
<p id="section-6.4-4">
          To prevent probe synchronization across tunnels, implementations
          SHOULD add random jitter of +/- 10% to each probe interval.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6.5">
<section id="section-6.5">
        <h3 id="name-tunnel-state-determination">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-tunnel-state-determination" class="section-name selfRef">Tunnel State Determination</a>
        </h3>
<p id="section-6.5-1">
          Tunnel state transitions are triggered by threshold crossings:<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">
          Degraded Thresholds:<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-3.1">
            <p id="section-6.5-3.1.1">RTT increases by more than 50% above baseline<a href="#section-6.5-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.5-3.2">
            <p id="section-6.5-3.2.1">Packet loss exceeds 1%<a href="#section-6.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.5-3.3">
            <p id="section-6.5-3.3.1">Jitter increases by more than 100% above baseline<a href="#section-6.5-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.5-4">
          Down Thresholds:<a href="#section-6.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-5.1">
            <p id="section-6.5-5.1.1">Five or more consecutive probe failures<a href="#section-6.5-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.5-5.2">
            <p id="section-6.5-5.2.1">Packet loss exceeds 25%<a href="#section-6.5-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.5-6">
          Thresholds SHOULD be configurable via the gRPC API.<a href="#section-6.5-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-7">
<section id="section-7">
      <h2 id="name-metric-publishing">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-metric-publishing" class="section-name selfRef">Metric Publishing</a>
      </h2>
<div id="sect-7.1">
<section id="section-7.1">
        <h3 id="name-publishing-methods">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-publishing-methods" class="section-name selfRef">Publishing Methods</a>
        </h3>
<p id="section-7.1-1">
          CONDUIT publishes tunnel metrics through multiple mechanisms to
          enable SRv6-based traffic engineering:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-7">
          <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Method</th>
              <th class="text-left" rowspan="1" colspan="1"> Target</th>
              <th class="text-left" rowspan="1" colspan="1"> Use Case</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Interface Metrics</td>
              <td class="text-left" rowspan="1" colspan="1">Operating system</td>
              <td class="text-left" rowspan="1" colspan="1">Simple deployments</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IGP TE Extensions</td>
              <td class="text-left" rowspan="1" colspan="1">IS-IS / OSPF</td>
              <td class="text-left" rowspan="1" colspan="1">Distributed TE</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">gRPC Streaming</td>
              <td class="text-left" rowspan="1" colspan="1">SDN Controller</td>
              <td class="text-left" rowspan="1" colspan="1">Centralized TE</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Flex-Algo Affinity</td>
              <td class="text-left" rowspan="1" colspan="1">IGP Flex-Algo</td>
              <td class="text-left" rowspan="1" colspan="1">Constraint-based TE</td>
            </tr>
          </tbody>
        </table>
<p id="section-7.1-3">
          Implementations MUST support interface metric publishing.
          Implementations SHOULD support IGP TE extensions and gRPC streaming.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.2">
<section id="section-7.2">
        <h3 id="name-interface-metric-calculatio">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-interface-metric-calculatio" class="section-name selfRef">Interface Metric Calculation</a>
        </h3>
<p id="section-7.2-1">
          CONDUIT calculates an interface metric from tunnel quality
          measurements using the following formula:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-2">
<pre>
   Metric = Latency_component + Loss_component + Jitter_component

Where:
</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-7.2-3.1">
            <p id="section-7.2-3.1.1">Latency_component = RTT_ms (1 ms = 1 metric unit)<a href="#section-7.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-3.2">
            <p id="section-7.2-3.2.1">Loss_component = Loss% x 100 (1% loss = 100 metric units)<a href="#section-7.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-3.3">
            <p id="section-7.2-3.3.1">Jitter_component = Jitter_ms x 10 (1 ms jitter = 10 metric units)<a href="#section-7.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-4">
          The resulting metric MUST be clamped to the range 1-65535.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">
          Example calculations:<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<table class="center" id="table-8">
          <caption><a href="#table-8" class="selfRef">Table 8</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Tunnel Type</th>
              <th class="text-left" rowspan="1" colspan="1"> RTT</th>
              <th class="text-left" rowspan="1" colspan="1"> Loss</th>
              <th class="text-left" rowspan="1" colspan="1"> Jitter</th>
              <th class="text-left" rowspan="1" colspan="1"> Metric</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">GEO SATCOM</td>
              <td class="text-left" rowspan="1" colspan="1">600 ms</td>
              <td class="text-left" rowspan="1" colspan="1">0.1%</td>
              <td class="text-left" rowspan="1" colspan="1">10 ms</td>
              <td class="text-left" rowspan="1" colspan="1">710</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">LOS Radio</td>
              <td class="text-left" rowspan="1" colspan="1">5 ms</td>
              <td class="text-left" rowspan="1" colspan="1">0%</td>
              <td class="text-left" rowspan="1" colspan="1">0.5 ms</td>
              <td class="text-left" rowspan="1" colspan="1">10</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">LTE Cellular</td>
              <td class="text-left" rowspan="1" colspan="1">50 ms</td>
              <td class="text-left" rowspan="1" colspan="1">0.5%</td>
              <td class="text-left" rowspan="1" colspan="1">5 ms</td>
              <td class="text-left" rowspan="1" colspan="1">150</td>
            </tr>
          </tbody>
        </table>
<p id="section-7.2-7">
          The SRv6 data plane, seeing these metrics, will naturally prefer the
          LOS tunnel (metric 10) over LTE (metric 150) over SATCOM (metric
          710) when computing shortest paths.<a href="#section-7.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.3">
<section id="section-7.3">
        <h3 id="name-igp-te-extensions">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-igp-te-extensions" class="section-name selfRef">IGP TE Extensions</a>
        </h3>
<p id="section-7.3-1">
          When IGP TE metric publishing is enabled, CONDUIT advertises the
          following per-tunnel attributes:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-2.1">
            <p id="section-7.3-2.1.1">TE Metric: Calculated as described in <a href="#sect-7.2" class="auto internal xref">Section 7.2</a><a href="#section-7.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.2">
            <p id="section-7.3-2.2.1">Maximum Link Bandwidth: Configured WAN bandwidth<a href="#section-7.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.3">
            <p id="section-7.3-2.3.1">Available Bandwidth: Estimated available capacity<a href="#section-7.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.4">
            <p id="section-7.3-2.4.1">Unidirectional Link Delay: Measured one-way delay per <span>[<a href="#RFC8570" class="cite xref">RFC8570</a>]</span><a href="#section-7.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.5">
            <p id="section-7.3-2.5.1">Unidirectional Delay Variation: Measured jitter per <span>[<a href="#RFC8570" class="cite xref">RFC8570</a>]</span><a href="#section-7.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.6">
            <p id="section-7.3-2.6.1">Unidirectional Packet Loss: Measured loss per <span>[<a href="#RFC8570" class="cite xref">RFC8570</a>]</span><a href="#section-7.3-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.7">
            <p id="section-7.3-2.7.1">Shared Risk Link Groups: Assigned SRLG values<a href="#section-7.3-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.8">
            <p id="section-7.3-2.8.1">Administrative Group: For Flex-Algo affinity matching<a href="#section-7.3-2.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.3-3"> For IS-IS, these attributes are advertised using the extensions defined in <span>[<a href="#RFC8570" class="cite xref">RFC8570</a>]</span>. For OSPF, the equivalent extensions from <span>[<a href="#RFC7471" class="cite xref">RFC7471</a>]</span> apply.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.4">
<section id="section-7.4">
        <h3 id="name-flex-algo-integration">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-flex-algo-integration" class="section-name selfRef">Flex-Algo Integration</a>
        </h3>
<p id="section-7.4-1">
          CONDUIT assigns tunnels to Flexible Algorithm groups based on
          measured characteristics and configured constraints.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">
          A Flex-Algo definition specifies:<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-3.1">
            <p id="section-7.4-3.1.1">Algorithm ID: An integer in the range 128-255<a href="#section-7.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-3.2">
            <p id="section-7.4-3.2.1">Metric Type: IGP metric, minimum delay, or TE metric<a href="#section-7.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-3.3">
            <p id="section-7.4-3.3.1">Constraints: Maximum delay, minimum bandwidth, SRLG exclusions<a href="#section-7.4-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-4">
          CONDUIT evaluates each tunnel against each Flex-Algo definition and
          sets the appropriate affinity bits in IGP advertisements.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<p id="section-7.4-5">
          Example Flex-Algo definitions for tactical networks:<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<p id="section-7.4-6">
          Flex-Algo 128 (Low Latency):<a href="#section-7.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-7.1">
            <p id="section-7.4-7.1.1">Metric Type: Minimum Delay<a href="#section-7.4-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-7.2">
            <p id="section-7.4-7.2.1">Constraint: Maximum delay 100 ms<a href="#section-7.4-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-7.3">
            <p id="section-7.4-7.3.1">Use: Voice, real-time C2<a href="#section-7.4-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-8">
          Flex-Algo 129 (High Bandwidth):<a href="#section-7.4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-9.1">
            <p id="section-7.4-9.1.1">Metric Type: IGP<a href="#section-7.4-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-9.2">
            <p id="section-7.4-9.2.1">Constraint: Minimum bandwidth 1 Mbps<a href="#section-7.4-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-9.3">
            <p id="section-7.4-9.3.1">Use: Video, bulk transfer<a href="#section-7.4-9.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-10">
          Flex-Algo 130 (Resilient):<a href="#section-7.4-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-11.1">
            <p id="section-7.4-11.1.1">Metric Type: IGP<a href="#section-7.4-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-11.2">
            <p id="section-7.4-11.2.1">Constraint: Exclude SRLG "satcom"<a href="#section-7.4-11.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-11.3">
            <p id="section-7.4-11.3.1">Use: Critical C2 requiring terrestrial diversity<a href="#section-7.4-11.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-12">
          With these definitions, the SRv6 data plane automatically steers
          voice traffic over low-latency tunnels (LOS radio), video over high-
          bandwidth tunnels (possibly ECMP across multiple), and critical C2
          over tunnels not sharing SATCOM failure modes.<a href="#section-7.4-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.5">
<section id="section-7.5">
        <h3 id="name-srlg-assignment">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-srlg-assignment" class="section-name selfRef">SRLG Assignment</a>
        </h3>
<p id="section-7.5-1">
          Shared Risk Link Groups identify tunnels that share common failure
          modes. CONDUIT assigns SRLG values based on:<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5-2.1">
            <p id="section-7.5-2.1.1">WAN Type: All tunnels using SATCOM share a "satcom" SRLG<a href="#section-7.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.5-2.2">
            <p id="section-7.5-2.2.1">Physical Path: Tunnels using the same physical link share an SRLG<a href="#section-7.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.5-2.3">
            <p id="section-7.5-2.3.1">Provider: Tunnels using the same carrier share an SRLG<a href="#section-7.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.5-2.4">
            <p id="section-7.5-2.4.1">Geographic: Tunnels transiting the same geographic area may share
              an SRLG<a href="#section-7.5-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.5-3">
          SRLG assignment enables SRv6 TI-LFA to compute backup paths that
          avoid shared failure modes and Flex-Algo to exclude entire failure
          domains.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-8">
<section id="section-8">
      <h2 id="name-control-protocol">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-control-protocol" class="section-name selfRef">Control Protocol</a>
      </h2>
<div id="sect-8.1">
<section id="section-8.1">
        <h3 id="name-transport">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-transport" class="section-name selfRef">Transport</a>
        </h3>
<p id="section-8.1-1">
          CONDUIT control messages are transported via UDP. Two ports are
          used:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1">
            <p id="section-8.1-2.1.1">Port 4794: Control messages (HELLO, WAN_UPDATE, etc.)<a href="#section-8.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.2">
            <p id="section-8.1-2.2.1">Port 4795: Probe packets<a href="#section-8.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-3">
          Control messages are transmitted through established IPsec tunnels
          when available. For initial peer discovery before tunnel
          establishment, messages may be sent via the underlying WAN with
          HMAC authentication.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.2">
<section id="section-8.2">
        <h3 id="name-message-header">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-message-header" class="section-name selfRef">Message Header</a>
        </h3>
<p id="section-8.2-1">
          All CONDUIT control messages share a common header:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-2">
<pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Version    |     Type      |            Flags              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Length             |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                         Node ID                               +
|                         (64 bits)                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Sequence Number                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                      Timestamp (64 bits)                      +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                      HMAC-SHA-384                             +
|                        (384 bits)                             |
+                                                               +
|                                                               |
+                                                               +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Field descriptions:
</pre><a href="#section-8.2-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-8.2-3">
          <dt id="section-8.2-3.1">Version (8 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-8.2-3.2">
            <p id="section-8.2-3.2.1">
              Protocol version. This specification defines<a href="#section-8.2-3.2.1" class="pilcrow">¶</a></p>
<p id="section-8.2-3.2.2">
              version 1.<a href="#section-8.2-3.2.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-3.3">Type (8 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-8.2-3.4">
            <p id="section-8.2-3.4.1"> Message type as defined in <a href="#sect-8.3" class="auto internal xref">Section 8.3</a>.<a href="#section-8.2-3.4.1" class="pilcrow">¶</a></p>
<p id="section-8.2-3.4.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-3.5">Flags (16 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-8.2-3.6">
            <p id="section-8.2-3.6.1">
              Message-specific flags.<a href="#section-8.2-3.6.1" class="pilcrow">¶</a></p>
<p id="section-8.2-3.6.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-3.7">Length (16 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-8.2-3.8">
            <p id="section-8.2-3.8.1">
              Total message length in octets, including header.<a href="#section-8.2-3.8.1" class="pilcrow">¶</a></p>
<p id="section-8.2-3.8.2"></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.2-4">
          Reserved (16 bits): Reserved for future use. MUST be zero.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.2-5">
          <dt id="section-8.2-5.1">Node ID (64 bits):</dt>
          <dd style="margin-left: 0.5em" id="section-8.2-5.2">
            <p id="section-8.2-5.2.1">
              Unique identifier of the sending node.<a href="#section-8.2-5.2.1" class="pilcrow">¶</a></p>
<p id="section-8.2-5.2.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-5.3">Sequence Number (32 bits):</dt>
          <dd style="margin-left: 0.5em" id="section-8.2-5.4">
            <p id="section-8.2-5.4.1">
              Per-peer monotonically increasing<a href="#section-8.2-5.4.1" class="pilcrow">¶</a></p>
<p id="section-8.2-5.4.2">
              counter for anti-replay protection.<a href="#section-8.2-5.4.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-5.5">Timestamp (64 bits):</dt>
          <dd style="margin-left: 0.5em" id="section-8.2-5.6">
            <p id="section-8.2-5.6.1">
              Message creation time in microseconds since<a href="#section-8.2-5.6.1" class="pilcrow">¶</a></p>
<p id="section-8.2-5.6.2">
              Unix epoch.<a href="#section-8.2-5.6.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-5.7">HMAC-SHA-384 (384 bits):</dt>
          <dd style="margin-left: 0.5em" id="section-8.2-5.8">
            <p id="section-8.2-5.8.1">
              Message authentication code computed over<a href="#section-8.2-5.8.1" class="pilcrow">¶</a></p>
<p id="section-8.2-5.8.2">
              the entire message with the HMAC field set to zero.<a href="#section-8.2-5.8.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.2-6">
          Total header size: 72 octets.<a href="#section-8.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.3">
<section id="section-8.3">
        <h3 id="name-message-types">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-message-types" class="section-name selfRef">Message Types</a>
        </h3>
<table class="center" id="table-9">
          <caption><a href="#table-9" class="selfRef">Table 9</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Value</th>
              <th class="text-left" rowspan="1" colspan="1"> Name</th>
              <th class="text-left" rowspan="1" colspan="1"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x01</td>
              <td class="text-left" rowspan="1" colspan="1">HELLO</td>
              <td class="text-left" rowspan="1" colspan="1">Peer discovery and WAN advertisement</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x02</td>
              <td class="text-left" rowspan="1" colspan="1">HELLO_ACK</td>
              <td class="text-left" rowspan="1" colspan="1">Response to HELLO</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x03</td>
              <td class="text-left" rowspan="1" colspan="1">WAN_UPDATE</td>
              <td class="text-left" rowspan="1" colspan="1">WAN availability change notification</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x04</td>
              <td class="text-left" rowspan="1" colspan="1">TUNNEL_STATE</td>
              <td class="text-left" rowspan="1" colspan="1">Tunnel state change notification</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x05</td>
              <td class="text-left" rowspan="1" colspan="1">KEEPALIVE</td>
              <td class="text-left" rowspan="1" colspan="1">Peer liveness check</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x06</td>
              <td class="text-left" rowspan="1" colspan="1">KEEPALIVE_ACK</td>
              <td class="text-left" rowspan="1" colspan="1">Response to KEEPALIVE</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0F</td>
              <td class="text-left" rowspan="1" colspan="1">ERROR</td>
              <td class="text-left" rowspan="1" colspan="1">Error notification</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-8.4">
<section id="section-8.4">
        <h3 id="name-hello-message">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-hello-message" class="section-name selfRef">HELLO Message</a>
        </h3>
<p id="section-8.4-1">
          The HELLO message is used for peer discovery and WAN capability
          advertisement:<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4-2">
<pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Num WANs    |   Reserved    |         Capabilities          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Hold Time (sec)        |        Max Tunnels            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                    SRv6 Locator (48 bits)                     +
|                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                      WAN Descriptors                          ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Field descriptions:
</pre><a href="#section-8.4-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-8.4-3">
          <dt id="section-8.4-3.1">Num WANs (8 bits):</dt>
          <dd style="margin-left: 0.5em" id="section-8.4-3.2">
            <p id="section-8.4-3.2.1">
              Number of WAN Descriptors following.<a href="#section-8.4-3.2.1" class="pilcrow">¶</a></p>
<p id="section-8.4-3.2.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-3.3">Capabilities (16 bits):</dt>
          <dd style="margin-left: 0.5em" id="section-8.4-3.4">
            <p id="section-8.4-3.4.1">
              Bitmask of supported capabilities.<a href="#section-8.4-3.4.1" class="pilcrow">¶</a></p>
<p id="section-8.4-3.4.2"></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-3.5">Hold Time (16 bits):</dt>
          <dd style="margin-left: 0.5em" id="section-8.4-3.6">
            <p id="section-8.4-3.6.1">
              Time in seconds the receiver should consider<a href="#section-8.4-3.6.1" class="pilcrow">¶</a></p>
<p id="section-8.4-3.6.2">
              the sender reachable without further messages.<a href="#section-8.4-3.6.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-3.7">Max Tunnels (16 bits):</dt>
          <dd style="margin-left: 0.5em" id="section-8.4-3.8">
            <p id="section-8.4-3.8.1">
              Maximum tunnels this node can establish to<a href="#section-8.4-3.8.1" class="pilcrow">¶</a></p>
<p id="section-8.4-3.8.2">
              a single peer.<a href="#section-8.4-3.8.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-3.9">SRv6 Locator (48 bits):</dt>
          <dd style="margin-left: 0.5em" id="section-8.4-3.10">
            <p id="section-8.4-3.10.1">
              The node's SRv6 locator prefix.<a href="#section-8.4-3.10.1" class="pilcrow">¶</a></p>
<p id="section-8.4-3.10.2"></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-8.5">
<section id="section-8.5">
        <h3 id="name-wan-descriptor">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-wan-descriptor" class="section-name selfRef">WAN Descriptor</a>
        </h3>
<p id="section-8.5-1">
          Each WAN interface is described by a WAN Descriptor:<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5-2">
<pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    WAN ID     |   WAN Type    |     State     | Addr Flags    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Bandwidth (Kbps)                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              MTU              |     Typical Latency (ms)      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                  IPv6 Address (if flag set)                   +
|                        (128 bits)                             |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  IPv4 Address (if flag set)                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            SRLG ID            |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

WAN Type values:
</pre><a href="#section-8.5-2" class="pilcrow">¶</a>
</div>
<table class="center" id="table-10">
          <caption><a href="#table-10" class="selfRef">Table 10</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Value</th>
              <th class="text-left" rowspan="1" colspan="1"> Name</th>
              <th class="text-left" rowspan="1" colspan="1"> Typical Characteristics</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x01</td>
              <td class="text-left" rowspan="1" colspan="1">SATCOM_GEO</td>
              <td class="text-left" rowspan="1" colspan="1">600ms RTT, 2-10 Mbps</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x02</td>
              <td class="text-left" rowspan="1" colspan="1">SATCOM_LEO</td>
              <td class="text-left" rowspan="1" colspan="1">30ms RTT, 50-200 Mbps</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x03</td>
              <td class="text-left" rowspan="1" colspan="1">LOS_RADIO</td>
              <td class="text-left" rowspan="1" colspan="1">5ms RTT, 10-100 Mbps</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x04</td>
              <td class="text-left" rowspan="1" colspan="1">TROPOSCATTER</td>
              <td class="text-left" rowspan="1" colspan="1">10ms RTT, 5-20 Mbps</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x05</td>
              <td class="text-left" rowspan="1" colspan="1">HF_RADIO</td>
              <td class="text-left" rowspan="1" colspan="1">50ms RTT, 9.6-64 Kbps</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x06</td>
              <td class="text-left" rowspan="1" colspan="1">CELLULAR_LTE</td>
              <td class="text-left" rowspan="1" colspan="1">30ms RTT, 10-100 Mbps</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x07</td>
              <td class="text-left" rowspan="1" colspan="1">CELLULAR_5G</td>
              <td class="text-left" rowspan="1" colspan="1">10ms RTT, 100-1000 Mbps</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x08</td>
              <td class="text-left" rowspan="1" colspan="1">WIRE_ETHERNET</td>
              <td class="text-left" rowspan="1" colspan="1">1ms RTT, 1-100 Gbps</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x09</td>
              <td class="text-left" rowspan="1" colspan="1">WIRE_FIBER</td>
              <td class="text-left" rowspan="1" colspan="1">1ms RTT, 1-100 Gbps</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0A</td>
              <td class="text-left" rowspan="1" colspan="1">WIFI</td>
              <td class="text-left" rowspan="1" colspan="1">5ms RTT, 50-500 Mbps</td>
            </tr>
          </tbody>
        </table>
<p id="section-8.5-4" class="keepWithPrevious"> Address Flags:<a href="#section-8.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5-5.1">
            <p id="section-8.5-5.1.1">Bit 0: IPv4 address present<a href="#section-8.5-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-5.2">
            <p id="section-8.5-5.2.1">Bit 1: IPv6 address present<a href="#section-8.5-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-5.3">
            <p id="section-8.5-5.3.1">Bit 2: Behind NAT (IPv4)<a href="#section-8.5-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-5.4">
            <p id="section-8.5-5.4.1">Bit 3: Behind NAT (IPv6)<a href="#section-8.5-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-8.6">
<section id="section-8.6">
        <h3 id="name-message-authentication">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-message-authentication" class="section-name selfRef">Message Authentication</a>
        </h3>
<p id="section-8.6-1">
          All CONDUIT control messages MUST be authenticated using HMAC-
          SHA-384.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.6-2">
          <dt id="section-8.6-2.1">The authentication key is derived from the IKEv2 SA when available:</dt>
          <dd style="margin-left: 0.5em" id="section-8.6-2.2"></dd>
        <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-8.6-3">
<pre>
   AUTH_KEY = HKDF-SHA-384(
      IKM = SK_d,
      salt = "CONDUIT-v1-auth",
      info = Node_ID_local || Node_ID_remote,
      length = 48
   )
</pre><a href="#section-8.6-3" class="pilcrow">¶</a>
</div>
<p id="section-8.6-4">
          For initial HELLO messages before IKEv2 SA establishment, a pre-
          shared key MAY be used. Unauthenticated HELLO messages MUST NOT be
          accepted in production deployments.<a href="#section-8.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.7">
<section id="section-8.7">
        <h3 id="name-anti-replay-protection">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-anti-replay-protection" class="section-name selfRef">Anti-Replay Protection</a>
        </h3>
<p id="section-8.7-1">
          Each peer maintains anti-replay state consisting of:<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.7-2.1">
            <p id="section-8.7-2.1.1">Expected sequence number (next expected value)<a href="#section-8.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-2.2">
            <p id="section-8.7-2.2.1">Window bitmap (received sequences within window)<a href="#section-8.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-2.3">
            <p id="section-8.7-2.3.1">Window size (default 64)<a href="#section-8.7-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-2.4">
            <p id="section-8.7-2.4.1">Maximum timestamp skew (default 60 seconds)<a href="#section-8.7-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.7-3">
          Message acceptance rules:<a href="#section-8.7-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.7-4">
          <li id="section-8.7-4.1">
            <p id="section-8.7-4.1.1">If sequence &gt;= expected: Accept and update expected<a href="#section-8.7-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.7-4.2">
            <p id="section-8.7-4.2.1">If sequence &lt; expected - window_size: Reject (too old)<a href="#section-8.7-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.7-4.3">
            <p id="section-8.7-4.3.1">If sequence in window and bit set: Reject (replay)<a href="#section-8.7-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.7-4.4">
            <p id="section-8.7-4.4.1">If sequence in window and bit clear: Accept and set bit<a href="#section-8.7-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.7-4.5">
            <p id="section-8.7-4.5.1">If timestamp differs from local time by more than maximum skew:
              Reject<a href="#section-8.7-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="sect-9">
<section id="section-9">
      <h2 id="name-srv6-integration">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-srv6-integration" class="section-name selfRef">SRv6 Integration</a>
      </h2>
<div id="sect-9.1">
<section id="section-9.1">
        <h3 id="name-tunnel-interfaces-as-srv6-a">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-tunnel-interfaces-as-srv6-a" class="section-name selfRef">Tunnel Interfaces as SRv6 Adjacencies</a>
        </h3>
<p id="section-9.1-1">
          Each CONDUIT tunnel is presented to the SRv6 data plane as a
          distinct interface. From the perspective of IS-IS or OSPFv3, each
          tunnel represents a separate adjacency to the peer node.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">
          This design enables:<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-3.1">
            <p id="section-9.1-3.1.1">Independent metrics per tunnel based on measured quality<a href="#section-9.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.2">
            <p id="section-9.1-3.2.1">ECMP load balancing across multiple tunnels to the same peer<a href="#section-9.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.3">
            <p id="section-9.1-3.3.1">Flex-Algo differentiation based on tunnel characteristics<a href="#section-9.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.4">
            <p id="section-9.1-3.4.1">TI-LFA backup path computation considering tunnel diversity<a href="#section-9.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.1-4">
          For example, a node with three tunnels to a peer (via SATCOM, LOS,
          and LTE) would advertise three adjacencies in IS-IS, each with its
          own metric. The IGP SPF computation naturally prefers lower-metric
          paths.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-9.2">
<section id="section-9.2">
        <h3 id="name-flex-algo-tunnel-assignment">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-flex-algo-tunnel-assignment" class="section-name selfRef">Flex-Algo Tunnel Assignment</a>
        </h3>
<p id="section-9.2-1">
          CONDUIT evaluates each tunnel against configured Flex-Algo
          definitions and assigns appropriate affinities.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">
          A tunnel qualifies for a Flex-Algo if:<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-3.1">
            <p id="section-9.2-3.1.1">Measured delay is less than the maximum delay constraint (if
              specified)<a href="#section-9.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-3.2">
            <p id="section-9.2-3.2.1">Configured bandwidth meets the minimum bandwidth constraint (if
              specified)<a href="#section-9.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-3.3">
            <p id="section-9.2-3.3.1">Tunnel SRLG membership does not intersect with excluded SRLGs (if
              specified)<a href="#section-9.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.2-4">
          Assignment is dynamic: as tunnel metrics change, Flex-Algo membership
          is re-evaluated and IGP advertisements are updated accordingly.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2-5">
          Example assignment for a deployment with three Flex-Algos:<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<table class="center" id="table-11">
          <caption><a href="#table-11" class="selfRef">Table 11</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Tunnel </th>
              <th class="text-left" rowspan="1" colspan="1"> Algo 128 (Low Lat)</th>
              <th class="text-left" rowspan="1" colspan="1"> Algo 129 (High BW)</th>
              <th class="text-left" rowspan="1" colspan="1"> Algo 130 (Resilient)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SATCOM (600ms)</td>
              <td class="text-left" rowspan="1" colspan="1">Excluded</td>
              <td class="text-left" rowspan="1" colspan="1">Included</td>
              <td class="text-left" rowspan="1" colspan="1">Excluded</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">LOS Radio (5ms)</td>
              <td class="text-left" rowspan="1" colspan="1">Included</td>
              <td class="text-left" rowspan="1" colspan="1">Included</td>
              <td class="text-left" rowspan="1" colspan="1">Included</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">LTE (50ms)</td>
              <td class="text-left" rowspan="1" colspan="1">Included</td>
              <td class="text-left" rowspan="1" colspan="1">Included</td>
              <td class="text-left" rowspan="1" colspan="1">Included</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.2-7">
          The SATCOM tunnel is excluded from Flex-Algo 128 (delay exceeds
          100ms threshold) and Flex-Algo 130 (SRLG "satcom" is excluded).<a href="#section-9.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-9.3">
<section id="section-9.3">
        <h3 id="name-traffic-steering">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-traffic-steering" class="section-name selfRef">Traffic Steering</a>
        </h3>
<p id="section-9.3-1">
          With CONDUIT providing tunnel metrics and Flex-Algo assignments,
          traffic steering is accomplished through standard SRv6 mechanisms:<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-2.1">
            <p id="section-9.3-2.1.1">SRv6 Policy Color: Traffic matching a policy with a specific
              color is steered to paths computed using the associated Flex-Algo<a href="#section-9.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-2.2">
            <p id="section-9.3-2.2.1">DSCP Mapping: DSCP values can be mapped to SRv6 policy colors<a href="#section-9.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-2.3">
            <p id="section-9.3-2.3.1">BGP Communities: BGP communities can signal desired Flex-Algo<a href="#section-9.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.3-3">
          Example mapping for tactical traffic:<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<table class="center" id="table-12">
          <caption><a href="#table-12" class="selfRef">Table 12</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Traffic Type</th>
              <th class="text-left" rowspan="1" colspan="1"> DSCP</th>
              <th class="text-left" rowspan="1" colspan="1"> SR Color</th>
              <th class="text-left" rowspan="1" colspan="1"> Flex-Algo</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Voice</td>
              <td class="text-left" rowspan="1" colspan="1">EF (46)</td>
              <td class="text-left" rowspan="1" colspan="1">100</td>
              <td class="text-left" rowspan="1" colspan="1">128 (Low Latency)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Video</td>
              <td class="text-left" rowspan="1" colspan="1">AF41 (34)</td>
              <td class="text-left" rowspan="1" colspan="1">200</td>
              <td class="text-left" rowspan="1" colspan="1">129 (High BW)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Critical C2</td>
              <td class="text-left" rowspan="1" colspan="1">CS6 (48)</td>
              <td class="text-left" rowspan="1" colspan="1">300</td>
              <td class="text-left" rowspan="1" colspan="1">130 (Resilient)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Best Effort</td>
              <td class="text-left" rowspan="1" colspan="1">BE (0)</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Default (SPF)</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="sect-10">
<section id="section-10">
      <h2 id="name-high-availability">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-high-availability" class="section-name selfRef">High Availability</a>
      </h2>
<div id="sect-10.1">
<section id="section-10.1">
        <h3 id="name-ha-architecture">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-ha-architecture" class="section-name selfRef">HA Architecture</a>
        </h3>
<p id="section-10.1-1">
          CONDUIT supports high availability through active-standby or active-
          active node pairs sharing a virtual IP address.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">
          In active-standby mode:<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-3.1">
            <p id="section-10.1-3.1.1">Primary node handles all tunnel management and peer communication<a href="#section-10.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-3.2">
            <p id="section-10.1-3.2.1">Standby node maintains synchronized state and pre-established
              tunnels<a href="#section-10.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-3.3">
            <p id="section-10.1-3.3.1">Failover occurs when primary failure is detected<a href="#section-10.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-4">
          In active-active mode:<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-5.1">
            <p id="section-10.1-5.1.1">Both nodes actively manage tunnels<a href="#section-10.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-5.2">
            <p id="section-10.1-5.2.1">Anycast addressing distributes peer connections<a href="#section-10.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-5.3">
            <p id="section-10.1-5.3.1">State synchronization ensures consistency<a href="#section-10.1-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-10.2">
<section id="section-10.2">
        <h3 id="name-synchronized-state">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-synchronized-state" class="section-name selfRef">Synchronized State</a>
        </h3>
<p id="section-10.2-1">
          The following state is synchronized between HA peers:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-13">
          <caption><a href="#table-13" class="selfRef">Table 13</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Data</th>
              <th class="text-left" rowspan="1" colspan="1"> Sync Method</th>
              <th class="text-left" rowspan="1" colspan="1"> Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Peer List</td>
              <td class="text-left" rowspan="1" colspan="1">Periodic + Event</td>
              <td class="text-left" rowspan="1" colspan="1">Both nodes know all peers</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Tunnel State</td>
              <td class="text-left" rowspan="1" colspan="1">Event-driven</td>
              <td class="text-left" rowspan="1" colspan="1">Enable fast failover</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Metrics</td>
              <td class="text-left" rowspan="1" colspan="1">Periodic (1 Hz)</td>
              <td class="text-left" rowspan="1" colspan="1">Consistent path costs</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Configuration</td>
              <td class="text-left" rowspan="1" colspan="1">Event-driven</td>
              <td class="text-left" rowspan="1" colspan="1">Policy consistency</td>
            </tr>
          </tbody>
        </table>
<p id="section-10.2-3">
          IKEv2 Security Associations are NOT synchronized. Each node
          maintains independent SAs with peers. This simplifies
          implementation and avoids complexities of SA state transfer.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-10.3">
<section id="section-10.3">
        <h3 id="name-failover-behavior">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-failover-behavior" class="section-name selfRef">Failover Behavior</a>
        </h3>
<p id="section-10.3-1">
          Upon detecting primary node failure:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3-2">
          <li id="section-10.3-2.1">
            <p id="section-10.3-2.1.1">Standby assumes the virtual IP address<a href="#section-10.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-10.3-2.2">
            <p id="section-10.3-2.2.1">Standby's pre-established tunnels become active<a href="#section-10.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-10.3-2.3">
            <p id="section-10.3-2.3.1">SRv6 reconverges via TI-LFA (sub-50ms for pre-computed backups)<a href="#section-10.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-10.3-2.4">
            <p id="section-10.3-2.4.1">Traffic flows through standby's tunnels<a href="#section-10.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-10.3-3">
          Target failover time is less than 3 seconds for complete recovery,
          with TI-LFA providing sub-50ms forwarding continuity for traffic
          with pre-computed backup paths.<a href="#section-10.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-11">
<section id="section-11">
      <h2 id="name-grpc-api">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-grpc-api" class="section-name selfRef">gRPC API</a>
      </h2>
<div id="sect-11.1">
<section id="section-11.1">
        <h3 id="name-service-overview">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-service-overview" class="section-name selfRef">Service Overview</a>
        </h3>
<p id="section-11.1-1">
          CONDUIT exposes all functionality through a gRPC API comprising three
          services:<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.1-2">
          <dt id="section-11.1-2.1">TunnelFabric Service:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.2">
            <p id="section-11.1-2.2.1">
              Primary interface for tunnel management,<a href="#section-11.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-11.1-2.2.2">
              including node configuration, WAN interface management, peer
              discovery and management, tunnel lifecycle operations, tunnel
              policy configuration, and metric publishing configuration.<a href="#section-11.1-2.2.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.3">Telemetry Service:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.4">
            <p id="section-11.1-2.4.1">
              Provides access to operational metrics, including<a href="#section-11.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-11.1-2.4.2">
              current tunnel metrics, real-time metric streaming, historical
              metric queries, and fabric statistics.<a href="#section-11.1-2.4.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.5">HighAvailability Service:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.6">
            <p id="section-11.1-2.6.1">
              Manages HA operations, including HA status<a href="#section-11.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-11.1-2.6.2">
              and configuration, synchronization status, and manual failover
              triggers.<a href="#section-11.1-2.6.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-11.1-3">
          The complete Protocol Buffer definitions for these services are
          available in a companion document.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-11.2">
<section id="section-11.2">
        <h3 id="name-authentication-and-authoriz">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-authentication-and-authoriz" class="section-name selfRef">Authentication and Authorization</a>
        </h3>
<p id="section-11.2-1"> All gRPC connections MUST use mutual TLS (mTLS) with certificates meeting the
          requirements of <a href="#sect-4.5" class="auto internal xref">Section 4.5</a>.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">
          Implementations SHOULD support role-based access control (RBAC) for
          API authorization. Recommended roles include:<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-3.1">
            <p id="section-11.2-3.1.1">Administrator: Full access to all operations<a href="#section-11.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-3.2">
            <p id="section-11.2-3.2.1">Operator: Read access plus tunnel state changes<a href="#section-11.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-3.3">
            <p id="section-11.2-3.3.1">Monitor: Read-only access to status and metrics<a href="#section-11.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sect-12">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="sect-12.1">
<section id="section-12.1">
        <h3 id="name-cryptographic-security">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-cryptographic-security" class="section-name selfRef">Cryptographic Security</a>
        </h3>
<p id="section-12.1-1">
          CONDUIT's security relies on the strength of its cryptographic
          foundations. The mandatory use of CNSA 2.0 algorithms provides
          protection appropriate for classified information.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2">
          Key security properties:<a href="#section-12.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-3.1">
            <p id="section-12.1-3.1.1">All tunnel traffic is protected by AES-256-GCM, providing
              confidentiality and integrity<a href="#section-12.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-3.2">
            <p id="section-12.1-3.2.1">All control messages are authenticated using HMAC-SHA-384<a href="#section-12.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-3.3">
            <p id="section-12.1-3.3.1">Key exchange uses ECDH with P-384, providing forward secrecy<a href="#section-12.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-3.4">
            <p id="section-12.1-3.4.1">Node authentication uses ECDSA with P-384 certificates<a href="#section-12.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-12.2">
<section id="section-12.2">
        <h3 id="name-threat-mitigations">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-threat-mitigations" class="section-name selfRef">Threat Mitigations</a>
        </h3>
<p id="section-12.2-1">
          CONDUIT addresses the following threats:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-14">
          <caption><a href="#table-14" class="selfRef">Table 14</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Threat</th>
              <th class="text-left" rowspan="1" colspan="1"> Mitigation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Probe Spoofing</td>
              <td class="text-left" rowspan="1" colspan="1">HMAC-SHA-384 authentication on all probes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Replay Attacks</td>
              <td class="text-left" rowspan="1" colspan="1">Sequence numbers and timestamp validation</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Man-in-the-Middle</td>
              <td class="text-left" rowspan="1" colspan="1">IPsec with certificate-based auth</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Unauthorized API</td>
              <td class="text-left" rowspan="1" colspan="1">Mutual TLS with certificate validation</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Tunnel Manipulation</td>
              <td class="text-left" rowspan="1" colspan="1">Authenticated control protocol messages</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Denial of Service</td>
              <td class="text-left" rowspan="1" colspan="1">Rate limiting on control plane</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-12.3">
<section id="section-12.3">
        <h3 id="name-operational-security">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-operational-security" class="section-name selfRef">Operational Security</a>
        </h3>
<p id="section-12.3-1">
          Deployments SHOULD implement the following operational security
          measures:<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.3-2.1">
            <p id="section-12.3-2.1.1">Certificates should be rotated at least annually<a href="#section-12.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.2">
            <p id="section-12.3-2.2.1">Private keys should be stored in hardware security modules (HSM)
              where available<a href="#section-12.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.3">
            <p id="section-12.3-2.3.1">All tunnel state changes should be logged for audit purposes<a href="#section-12.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.4">
            <p id="section-12.3-2.4.1">Rate limiting should be applied to control plane message
              processing<a href="#section-12.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.5">
            <p id="section-12.3-2.5.1">Network segmentation should isolate CONDUIT management traffic<a href="#section-12.3-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sect-13">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="sect-13.1">
<section id="section-13.1">
        <h3 id="name-udp-port-allocation">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-udp-port-allocation" class="section-name selfRef">UDP Port Allocation</a>
        </h3>
<p id="section-13.1-1">
          This document requests allocation of two UDP ports:<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-15">
          <caption><a href="#table-15" class="selfRef">Table 15</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Port</th>
              <th class="text-left" rowspan="1" colspan="1"> Name</th>
              <th class="text-left" rowspan="1" colspan="1"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4794</td>
              <td class="text-left" rowspan="1" colspan="1">conduit-control</td>
              <td class="text-left" rowspan="1" colspan="1">CONDUIT control messages</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4795</td>
              <td class="text-left" rowspan="1" colspan="1">conduit-probe</td>
              <td class="text-left" rowspan="1" colspan="1">CONDUIT probe packets</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-13.2">
<section id="section-13.2">
        <h3 id="name-wan-type-registry">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-wan-type-registry" class="section-name selfRef">WAN Type Registry</a>
        </h3>
<p id="section-13.2-1">
          This document requests creation of a "CONDUIT WAN Types" registry
          with the following initial values:<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.2-2">
<pre>
+-------+----------------+-------------------------+
| Value | Name           | Reference               |
+-------+----------------+-------------------------+
|  0x00 | Reserved       | This document           |
|  0x01 | SATCOM_GEO     | This document           |
|  0x02 | SATCOM_LEO     | This document           |
|  0x03 | LOS_RADIO      | This document           |
|  0x04 | TROPOSCATTER   | This document           |
|  0x05 | HF_RADIO       | This document           |
|  0x06 | CELLULAR_LTE   | This document           |
|  0x07 | CELLULAR_5G    | This document           |
|  0x08 | WIRE_ETHERNET  | This document           |
|  0x09 | WIRE_FIBER     | This document           |
|  0x0A | WIFI           | This document           |
| 0x0B-0xEF | Unassigned |                         |
| 0xF0-0xFF | Private Use | This document          |
+-------+----------------+-------------------------+

New values in the range 0x0B-0xEF require Standards Action.
</pre><a href="#section-13.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<section id="section-14">
      <h2 id="name-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-14.1">
        <h3 id="name-normative-references">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8570">[RFC8570]</dt>
        <dd>
<span class="refAuthor">Ginsberg, L., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Giacalone, S.</span>, <span class="refAuthor">Ward, D.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"IS-IS Traffic Engineering (TE) Metric Extensions"</span>, <span class="seriesInfo">RFC 8570</span>, <span class="seriesInfo">DOI 10.17487/RFC8570</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8570">https://www.rfc-editor.org/info/rfc8570</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8986">[RFC8986]</dt>
      <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Camarillo, P., Ed.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Voyer, D.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">Z. Li</span>, <span class="refTitle">"Segment Routing over IPv6 (SRv6) Network Programming"</span>, <span class="seriesInfo">RFC 8986</span>, <span class="seriesInfo">DOI 10.17487/RFC8986</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8986">https://www.rfc-editor.org/info/rfc8986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-14.2">
        <h3 id="name-informative-references">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3550">[RFC3550]</dt>
        <dd>
<span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">Casner, S.</span>, <span class="refAuthor">Frederick, R.</span>, and <span class="refAuthor">V. Jacobson</span>, <span class="refTitle">"RTP: A Transport Protocol for Real-Time Applications"</span>, <span class="seriesInfo">STD 64</span>, <span class="seriesInfo">RFC 3550</span>, <span class="seriesInfo">DOI 10.17487/RFC3550</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3550">https://www.rfc-editor.org/info/rfc3550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4868">[RFC4868]</dt>
        <dd>
<span class="refAuthor">Kelly, S.</span> and <span class="refAuthor">S. Frankel</span>, <span class="refTitle">"Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec"</span>, <span class="seriesInfo">RFC 4868</span>, <span class="seriesInfo">DOI 10.17487/RFC4868</span>, <time datetime="2007-05" class="refDate">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4868">https://www.rfc-editor.org/info/rfc4868</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7471">[RFC7471]</dt>
      <dd>
<span class="refAuthor">Giacalone, S.</span>, <span class="refAuthor">Ward, D.</span>, <span class="refAuthor">Drake, J.</span>, <span class="refAuthor">Atlas, A.</span>, and <span class="refAuthor">S. Previdi</span>, <span class="refTitle">"OSPF Traffic Engineering (TE) Metric Extensions"</span>, <span class="seriesInfo">RFC 7471</span>, <span class="seriesInfo">DOI 10.17487/RFC7471</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7471">https://www.rfc-editor.org/info/rfc7471</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="sect-a">
<section id="appendix-A">
      <h2 id="name-wan-type-characteristics">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-wan-type-characteristics" class="section-name selfRef">WAN Type Characteristics</a>
      </h2>
<p id="appendix-A-1">
        The following table provides typical characteristics for each WAN
        type. Actual values vary based on specific equipment, configuration,
        and environmental conditions.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<table class="center" id="table-16">
        <caption><a href="#table-16" class="selfRef">Table 16</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1"> WAN Type</th>
            <th class="text-left" rowspan="1" colspan="1"> Latency</th>
            <th class="text-left" rowspan="1" colspan="1"> Bandwidth</th>
            <th class="text-left" rowspan="1" colspan="1"> Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">SATCOM_GEO</td>
            <td class="text-left" rowspan="1" colspan="1">600ms</td>
            <td class="text-left" rowspan="1" colspan="1">2-10 Mbps</td>
            <td class="text-left" rowspan="1" colspan="1">Weather sensitive</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">SATCOM_LEO</td>
            <td class="text-left" rowspan="1" colspan="1">20-40ms</td>
            <td class="text-left" rowspan="1" colspan="1">50-200 Mbps</td>
            <td class="text-left" rowspan="1" colspan="1">Handover during orbit</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">LOS_RADIO</td>
            <td class="text-left" rowspan="1" colspan="1">5ms</td>
            <td class="text-left" rowspan="1" colspan="1">10-100 Mbps</td>
            <td class="text-left" rowspan="1" colspan="1">Terrain dependent</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TROPOSCATTER</td>
            <td class="text-left" rowspan="1" colspan="1">10ms</td>
            <td class="text-left" rowspan="1" colspan="1">5-20 Mbps</td>
            <td class="text-left" rowspan="1" colspan="1">Over-horizon capability</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">HF_RADIO</td>
            <td class="text-left" rowspan="1" colspan="1">50ms</td>
            <td class="text-left" rowspan="1" colspan="1">9.6-64 Kbps</td>
            <td class="text-left" rowspan="1" colspan="1">Atmospheric effects</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">CELLULAR_LTE</td>
            <td class="text-left" rowspan="1" colspan="1">30ms</td>
            <td class="text-left" rowspan="1" colspan="1">10-100 Mbps</td>
            <td class="text-left" rowspan="1" colspan="1">Coverage dependent</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">CELLULAR_5G</td>
            <td class="text-left" rowspan="1" colspan="1">10ms</td>
            <td class="text-left" rowspan="1" colspan="1">100-1000 Mbps</td>
            <td class="text-left" rowspan="1" colspan="1">Limited coverage</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">WIRE_ETHERNET</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;1ms</td>
            <td class="text-left" rowspan="1" colspan="1">1-100 Gbps</td>
            <td class="text-left" rowspan="1" colspan="1">Fixed installations</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">WIRE_FIBER</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;1ms</td>
            <td class="text-left" rowspan="1" colspan="1">1-100 Gbps</td>
            <td class="text-left" rowspan="1" colspan="1">Fixed installations</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">WIFI</td>
            <td class="text-left" rowspan="1" colspan="1">5ms</td>
            <td class="text-left" rowspan="1" colspan="1">50-500 Mbps</td>
            <td class="text-left" rowspan="1" colspan="1">Short range</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1"> The authors thank the members of the tactical networking community for their input on
        operational requirements and deployment considerations.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Edward Willman V</span></div>
<div dir="auto" class="left"><span class="org">Department of the Air Force</span></div>
<div dir="auto" class="left"><span class="street-address">1800 Air Force Pentagon</span></div>
<div dir="auto" class="left">
<span class="locality">Washington</span>, <span class="region">DC</span> <span class="postal-code">20330</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20786%20994%203023" class="tel">+1 786 994 3023</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.willman.1@us.af.mil" class="email">john.willman.1@us.af.mil</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.linkedin.com/in/johnewillmanv" class="url">https://www.linkedin.com/in/johnewillmanv</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
